{% extends "base.html" %}

{% block title %}Dataset: {{ filename }} | Patterns Matter{% endblock %}
{% set page_title = "Dataset: " ~ filename %}
{% set page_description = "Table view and CSV export for “" ~ filename ~ "”." %}

{% block content %}
<div class="container">
  <!-- Admin Login/Logout (kept as in your originals) -->
  <div class="admin-link" style="text-align: right; margin-bottom: 1em;">
    {% if session.admin %}
      <a href="{{ url_for('logout') }}">Logout</a>
    {% else %}
      <a href="{{ url_for('login') }}">Admin Login</a>
    {% endif %}
  </div>

  <h2>Dataset: {{ filename }}</h2>

  {# Flash messages (base.html already shows global flashes; this keeps your local list too) #}
  {% with messages = get_flashed_messages() %}
    {% if messages %}
      <ul class="msg">
        {% for message in messages %}
          <li>{{ message }}</li>
        {% endfor %}
      </ul>
    {% endif %}
  {% endwith %}

  <div class="actions" style="margin:.8em 0 1.2em;">
    {% if admin %}
      {# Kept exactly as you had; if your route doesn’t accept POST, just don’t press this button #}
      <form method="post" style="display:inline;">
        <button type="submit" name="import_sql">Import as SQL Table</button>
      </form>
      {% if imported_table %}
        <p style="display:inline-block; margin-left:.8em;">
          Will be imported as table: <strong>{{ imported_table }}</strong>
        </p>
      {% endif %}
      <p style="margin-top:.6em;"><a href="{{ url_for('admin_home') }}">Back to Dashboard</a></p>
    {% else %}
      <a href="{{ url_for('public_home') }}">Back to Data Portal</a>
    {% endif %}
  </div>

  <div>
    {% for table in tables %}
      {{ table|safe }}
    {% endfor %}
  </div>

  <div class="actions" style="margin-top:1em;">
    {% if imported_table %}
      <a href="{{ url_for('download', table=imported_table) }}">Download as CSV</a>
    {% else %}
      <span class="small">No exportable table name available.</span>
    {% endif %}
  </div>
</div>
{% endblock %}